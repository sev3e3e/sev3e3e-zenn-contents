---
title: "Next.js 13ã§Client Componentã«Dateã‚’å«ã‚€Propsã‚’æ¸¡ã—ãŸã„"
emoji: "ğŸ¤–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["nextjs", "typescript", "react"]
published: true
---

Next.js 13ã®App dirã«ã¦é–‹ç™ºä¸­ã€æ¬¡ã®ã‚ˆã†ãªè­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ‰ãƒãƒ‰ãƒæµã‚Œã¦ã„ã‚‹äº‹ã«æ°—ã¥ãã¾ã—ãŸã€‚

```
Warning: Only plain objects can be passed to Client Components from Server Components.
Date objects are not supported.
```

Client Componentã«æ¸¡ã—ã¦ã„ã‚‹Propsã«å‹ãŒDateã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã«ç™ºç”Ÿã™ã‚‹ã‚ˆã†ã§ã™ã€‚

è­¦å‘Šãªã®ã§ç„¡è¦–ã—ã¦ã‚‚è‰¯ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€[ãƒãƒ¼ã‚¸ãƒ§ãƒ³13ä»¥å‰ã¯ã‚¨ãƒ©ãƒ¼ã ã£ãŸ](#ä½™è«‡)ä¸Šã«ãƒ­ã‚°ãŒåŸ‹ã¾ã‚‹ã®ã§è­¦å‘Šã‚’å‡ºãªã„ã‚ˆã†ã«ã—ãŸã„ã§ã™ã€‚

ãã‚Œã§ã¯ã‚„ã£ã¦ã„ãã¾ã—ã‚‡ã†ğŸ’ª

# ç’°å¢ƒ

- Next.js 13 (App dir)
- TypeScript

# ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

[superjson](https://github.com/blitz-js/superjson)ã¨[next-superjson-plugin](https://github.com/blitz-js/next-superjson-plugin)ã‚’ä½¿ã„ã¾ã™ã€‚

```shell
yarn add superjson next-superjson-plugin
```

`next.config.js`ã«ä¸‹è¨˜ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```js:next.config.js
module.exports = {
  experimental: {
    swcPlugins: [["next-superjson-plugin", {}]],
  },
};
```

ã“ã‚Œã§æº–å‚™å®Œäº†ã§ã™ï¼ğŸ‰


# ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã

ä½¿ã„æ–¹ã¯ã¨ã£ã¦ã‚‚ç°¡å˜ã€‚

ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºå¿…é ˆã®propsã‚’æ¸¡ã™æ™‚ã«`data-superjson`å±æ€§ã‚’ä»˜ä¸ã™ã‚‹ã ã‘ã§ã™ã€‚

```tsx
export default function ServerComponent() {
    const date = new Date();
    return <ClientComponent date={date} data-superjson />;
}
```

ç°¡å˜ï¼ï¼ï¼ğŸ‰ğŸ‰

# ä½™è«‡

`Date objects are not supported.`ã§åˆ†ã‹ã‚‹æ–¹ã‚‚ã„ã‚‹ã¨æ€ã„ã¾ã™ãŒã€ã“ã‚Œã¯Next.js 13ä»¥å‰ã®`getServerSideProps`ã‚„`getStaticProps`å†…ã§Dateã‚’å«ã‚€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™ã¨ç™ºç”Ÿã™ã‚‹ãƒ»ãƒ»ãƒ»

```shell
Reason: `object` ("[object Date]") cannot be serialized as JSON. 
Please only return JSON serializable data types.
```

ã“ã®ã‚¨ãƒ©ãƒ¼ã¨ä¸€ç·’ã§ã™ã€‚

ã—ã‹ã—Next.js 13ã®App dirã¯`getServerSideProps`ã‚„`getStaticProps`ç­‰ãŒå»ƒæ­¢ã«ã€‚ä»£ã‚ã‚Šã«Server Componentã‹ã‚‰ç›´æ¥fetchã™ã‚‹ã‚ˆã†ã«å¤‰æ›´ã•ã‚Œã¦ã„ã¾ã™ã€‚

ãƒãƒ¼ã‚¸ãƒ§ãƒ³13ä»¥å‰ã¯[ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ä¸Šã®ç†ç”±](https://github.com/vercel/next.js/issues/13209#issuecomment-633149650)ã«ã‚ˆã‚Šäº‹å‰ã®ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºãŒå¿…é ˆã§ã—ãŸãŒã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³13ã«ãªã£ã¦ä½•ã‹å¤‰ã‚ã£ãŸã®ã§ã—ã‚‡ã†ã‹ãƒ»ãƒ»ãƒ»ã€‚